---
categories:
- paper
- medical-ai
date: 2024-04-06
excerpt: ADAPT는 3D MRI를 차원별 2D 시퀀스로 나눠 학습하며 ADNI 테스트 정확도 92.4%, AIBL 91.0%로 3D CNN
  대비 최대 19pt 향상한 결과를 보여줍니다.
header: {}
last_modified_at: '2025-09-16'
published: true
tags:
- Transformer
- 2Dslice
- cross-attention
- Brain
title: 'ADAPT: Alzheimer’s Diagnosis through Adaptive Profiling Transformers'
toc: true
toc_sticky: true
---
# ADAPT: Alzheimer’s Diagnosis through Adaptive Profiling Transformers

## 0. 체크리스트
- [x] `categories` 두 번째 값이 `medical-ai`로 맞춰져 있나요?
- [x] `excerpt`에 주요 성능 수치를 포함했나요?
- [x] 모든 섹션을 실제 내용으로 채웠나요?
- [x] 결과 표를 핵심 지표 중심으로 정리했나요?
- [x] 참고 링크를 정리했나요?

## 1. 핵심 요약 (3문장 이하)
- ADAPT는 3D MRI를 축·관상·시상 차원으로 분할한 뒤, 차원별·슬라이스별 트랜스포머 블록을 통해 알츠하이머 병변을 학습하는 2D 기반 진단 모델입니다.
- ADNI 테스트 정확도 92.4%, AIBL 91.0%, MIRIAD 90.3%를 기록해 가장 강력한 3D CNN(ADNI 84.3%) 대비 최대 19.1pt 성능을 확보하면서도 파라미터 수를 9.7M으로 줄였습니다.
- morphology augmentation과 adaptive training으로 차원별 중요도를 반영해, 다기관 데이터에서도 안정적인 일반화를 달성했습니다.

## 2. 배경 & 동기
- 3D CNN은 MRI의 전역 정보를 처리할 수 있지만 파라미터가 방대하고 연산량이 커 임상 적용이 어렵습니다.
- 2D CNN은 연산 효율이 뛰어나지만 3D 구조 정보를 놓쳐 진단 정확도가 낮습니다.
- 실제 임상에서 의사가 슬라이스를 차원별로 탐색한다는 점에 착안해, 차원별 관계와 슬라이스 간 상호작용을 명시적으로 학습하는 순수 트랜스포머 접근을 제안합니다.

## 3. 방법론
### 3.1 전체 구조
- ADNI MRI를 224×224×224로 정규화한 뒤, 축·관상·시상 방향에서 각각 16장의 등간격 슬라이스를 추출하여 총 48장의 2D 시퀀스를 구성합니다.
- 입력 시퀀스는 차원 공유 self-attention → 차원 전용 self-attention → intra-dimension cross-attention → inter-dimension fusion의 네 단계 트랜스포머 인코더를 통과합니다.
- 최종적으로 모든 차원의 대표 토큰을 융합하고 MLP 헤드가 AD/NC 이진 분류 확률을 출력합니다.

### 3.2 핵심 기법
- **Fusion Attention**: 슬라이스 수준·차원 수준 cross-attention을 연달아 적용해 차원별 특징을 보존하면서도 전역 정보를 결합합니다.
- **Adaptive Training**: 차원별 중요한 슬라이스를 동적으로 샘플링해, 의사가 특정 차원을 집중해서 보는 전략을 모사합니다.
- **Morphology Augmentation**: MCI 사례에 대해 atrophy expansion/reduction을 적용해 AD와 NC로 두 번 학습시키며, 정상/질환 스캔에도 0.5 확률로 형태 변형을 주어 데이터 효율을 높입니다.

### 3.3 학습 및 구현 세부
- N4ITK 바이어스 보정, MNI 공간 정합(ANTs SyN), 배경 크롭, 1mm 등방성 리샘플링을 수행한 후 Torchio 라이브러리로 전처리를 통일했습니다.
- Min–Max 정규화와 zero-mean unit-variance 스케일링을 적용하고, 사전학습된 2D ViT 가중치를 초기화에 사용했습니다.
- AdamW(learning rate 1e-4)와 cosine 스케줄을 사용했으며, 배치 16 기준 GPU 메모리 요구량은 약 8GB로 3D CNN 대비 현저히 낮습니다.

## 4. 실험 & 결과
### 4.1 설정
- **학습/검증**: ADNI에서 AD 384, NC 381, MCI 787을 활용해 학습(확장 후 1,898샘플), 139샘플 검증.
- **평가**: ADNI test(266 NC/145 AD), AIBL, MIRIAD, OASIS 전체를 외부 테스트 세트로 사용했고, 정확도(ACC)를 보고했습니다.
- **비교 기준**: MedicalNet, 3D ResNet/DenseNet, Knowledge4D, Uni4Eye 등 3D CNN·ViT 계열 모델과 파라미터 효율/성능을 비교했습니다.

### 4.2 주요 결과표
| Dataset | 최고 3D baseline ACC | ADAPT ACC | Δ |
| ------- | -------------------- | --------- | --- |
| ADNI test | 0.843 (MedicalNet-10) | **0.924** | +0.081 |
| AIBL | 0.856 (MedicalNet-10) | **0.910** | +0.054 |
| MIRIAD | 0.847 (MedicalNet-10) | **0.903** | +0.056 |
| OASIS | 0.809 (MedicalNet-18) | **0.817** | +0.008 |

### 4.3 추가 분석
- Fusion attention을 제거하면 ADNI 테스트 정확도가 92.4%→82.0%로 급락해 차원 융합 설계의 중요성이 확인되었습니다.
- Morphology augmentation, guide embedding, adaptive sampling을 각각 제거하면 ADNI 정확도가 73.8~85.5%로 하락해, 데이터 증강과 학습 전략이 일반화에 기여함을 입증했습니다.
- Encoder 깊이를 1+1+2+2에서 축소하면 성능이 떨어지고, 더 깊게 쌓으면 메모리 비용만 증가해 현재 구성이 성능/효율 균형을 이룹니다.

## 5. 의의 & 한계
- 3D MRI를 2D 트랜스포머로 처리하면서도 다기관 데이터에서 3D CNN을 압도하는 정확도와 5~10배 적은 파라미터 수를 달성했습니다.
- 차원별 중요도와 형태 변화를 학습하도록 설계돼, 실제 영상 판독 흐름을 모델링한 점이 임상 적용 가능성을 높입니다.
- 다만 AD/NC 이진 분류에 초점을 맞춰 MCI 세분화나 다중 병리 분류에는 추가 연구가 필요하며, morphology 증강의 하이퍼파라미터 민감도가 존재합니다.

## 6. 개인 평가
**강점**: 단순한 2D 처리로 3D 모델 수준의 성능을 확보하고, 차원별 attention 구조와 형태 증강을 통해 일반화가 뛰어납니다.  
**약점**: 분류 대상이 제한적이며, adaptive sampling·증강 전략의 구성 요소가 많아 재현 시 튜닝 비용이 큽니다.  
**적용 가능성**: 데이터가 제한된 의료 영상 분류 프로젝트에서 경량 고성능 백본으로 유용하며, 다기관 상황에서도 안정적입니다.  
**추천도**: ★★★★☆ (의료 영상용 트랜스포머 설계를 탐색하는 팀에 강력 추천)

## 7. 참고 자료
- 원문: [ADAPT: Alzheimer’s Diagnosis through Adaptive Profiling Transformers](https://arxiv.org/abs/2401.06349)
- 코드: [GitHub - haohanwang/ADAPT (예시 리포지토리)](https://github.com/haohanwang/ADAPT)
- 데이터: [ADNI](https://adni.loni.usc.edu/), [AIBL](https://aibl.csiro.au/), [MIRIAD](https://nupic.ncl.ac.uk/), [OASIS](https://www.oasis-brains.org/)
